version: 2

defaults: &defaults
  working_directory: /home/pi/
  # docker:
  # build:
  docker:
    - image: circleci/python:3.6
    # steps:
    #   - checkout
    #   - run:
    #       name: Setup VirtualEnv
    #       command: |
    #         virtualenv helloworld
    #         . helloworld/bin/activate
    #         python -m pip install --upgrade pip
    #         pip install --no-cache-dir -r requirements.txt
    #   - run:
    #       name: Run Tests
    #       command: |
    #         . helloworld/bin/activate
    #         python test_hello_world.py

run_feature_tests:
    <<: *defaults
    steps:
      - checkout
      - attach_workspace:
          at: /home/pi/
      - add_ssh_keys:
          fingerprints:
            - "ea:e5:57:46:5c:c2:8c:b4:fc:5d:68:91:e8:1b:0d:3e"
      - run:
          name: Clone frontend repository
          command: >-
            GIT_SSH_COMMAND='ssh -i /home/.ssh/id_rsa'
            git clone git@github.com:sememan/hello.git /home/pi/
